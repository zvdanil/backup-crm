# –û—á–∏—Å—Ç–∫–∞ "–º—É—Å–æ—Ä–Ω—ã—Ö" –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø–µ–¥–∞–≥–æ–≥–∞

## üìä –ü—Ä–æ–±–ª–µ–º–∞

–í —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø–µ–¥–∞–≥–æ–≥–∞ (`staff_journal_entries`) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –∂—É—Ä–Ω–∞–ª–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏. –≠—Ç–æ –æ—Å—Ç–∞—Ç–∫–∏ –æ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã.

## üîç –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ

**–¢–∞–±–ª–∏—Ü–∞:** `staff_journal_entries`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `id` - ID –∑–∞–ø–∏—Å–∏
- `staff_id` - ID –ø–µ–¥–∞–≥–æ–≥–∞
- `activity_id` - ID –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL)
- `group_lesson_id` - ID –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL)
- `date` - –î–∞—Ç–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
- `amount` - –°—É–º–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
- `is_manual_override` - –†—É—á–Ω–∞—è –∑–∞–ø–∏—Å—å (true/false)
- `notes` - –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ "–º—É—Å–æ—Ä–Ω—ã—Ö" –∑–∞–ø–∏—Å–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor –≤ DBeaver (Ctrl+`)
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `check_staff_journal_orphaned.sql` (Ctrl+O)
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ **–≤–µ—Å—å —Å–∫—Ä–∏–ø—Ç** (Ctrl+A, –∑–∞—Ç–µ–º F5)
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã - —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ

**–ß—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- –ó–∞–ø–∏—Å–∏ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è–º–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
- –ó–∞–ø–∏—Å–∏ —Å –≥—Ä—É–ø–ø–æ–≤—ã–º–∏ –∑–∞–Ω—è—Ç–∏—è–º–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —Å–µ—Å—Å–∏–π
- –†—É—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ —Å–≤—è–∑–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
- –°–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –®–∞–≥ 2: –û—á–∏—Å—Ç–∫–∞ (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)

**–í–ê–ñ–ù–û:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏!

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `cleanup_staff_journal_orphaned.sql` –≤ SQL Editor
2. **–í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ!
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç (F5)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

## üéØ –ß—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 1: –ó–∞–ø–∏—Å–∏ –±–µ–∑ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
- –ó–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ù–æ –¥–ª—è —ç—Ç–∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π –∏ –¥–∞—Ç –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
- –≠—Ç–æ –æ—Å—Ç–∞—Ç–∫–∏ –æ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞, –∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ—Å—Ç–∞–ª–∏—Å—å

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 2: –ó–∞–ø–∏—Å–∏ –±–µ–∑ —Å–µ—Å—Å–∏–π –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π
- –ó–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏—è
- –ù–æ –¥–ª—è —ç—Ç–∏—Ö –∑–∞–Ω—è—Ç–∏–π –∏ –¥–∞—Ç –Ω–µ—Ç —Å–µ—Å—Å–∏–π
- –≠—Ç–æ –æ—Å—Ç–∞—Ç–∫–∏ –æ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è 3: –†—É—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ —Å–≤—è–∑–∏
- –†—É—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`is_manual_override = true`)
- –ö–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –Ω–∏ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é, –Ω–∏ —Å –≥—Ä—É–ø–ø–æ–≤—ã–º –∑–∞–Ω—è—Ç–∏–µ–º
- –ò–ª–∏ —Å–≤—è–∑–∞–Ω—ã —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è–º–∏/–∑–∞–Ω—è—Ç–∏—è–º–∏

## ‚ö†Ô∏è –ß—Ç–æ –ù–ï –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ

- ‚úÖ –ó–∞–ø–∏—Å–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
- ‚úÖ –ó–∞–ø–∏—Å–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Å—Å–∏–∏ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π
- ‚úÖ –†—É—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–≤—è–∑–∞–Ω—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è–º–∏/–∑–∞–Ω—è—Ç–∏—è–º–∏
- ‚úÖ –ó–∞–ø–∏—Å–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π `expense`, `household_expense`, `salary` (–µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è–º–∏)

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –†—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ DBeaver:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `staff_journal_entries` –≤ DBeaver
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∏–∑ `check_staff_journal_orphaned.sql`
3. –ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –∑–∞–ø–∏—Å–∏
4. –£–¥–∞–ª–∏—Ç–µ –∏—Ö –≤—Ä—É—á–Ω—É—é (–ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí Delete)

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –∏—Å—Ç–æ—Ä–∏—é –ø–µ–¥–∞–≥–æ–≥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ "–º—É—Å–æ—Ä–Ω—ã–µ" –∑–∞–ø–∏—Å–∏ –∏—Å—á–µ–∑–ª–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω—É–∂–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –æ—Å—Ç–∞–ª–∏—Å—å
4. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –±—ç–∫–∞–ø–∞

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ** - –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `check_staff_journal_orphaned.sql`
2. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏
3. **–°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø** - —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å `dump-postgres-202601230001`
4. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –æ—á–∏—Å—Ç–∫—É** - `cleanup_staff_journal_orphaned.sql`
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ

## üéØ –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?

1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `check_staff_journal_orphaned.sql` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
2. –ü—Ä–∏—à–ª–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã - —è –ø–æ–º–æ–≥—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ —É–¥–∞–ª—è—Ç—å
3. –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `cleanup_staff_journal_orphaned.sql` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
